#!/usr/bin/env node

const app = require('../app');
const PORT = process.env.PORT || 3000
const HTTPS_PORT = process.env.HTTPS_PORT || 433
const logger = require('@condor-labs/logger');
const { getEnv } = require('../helpers')
const connectRedis = require('../config/redis/connet')
const connetMongo = require('../config/mongodb/connet')
const fs = require('fs');
const http = require('http');
const https = require('https');


const httpsServerOptions = {
    key: fs.readFileSync(process.env.KEY_PATH),
    cert: fs.readFileSync(process.env.CERT_PATH),
}

connetMongo()
connectRedis()

http.createServer(app).listen(PORT, () => {
    logger.info(`Server is running on port ${PORT}`);
    getEnv();
})


https.createServer(httpsServerOptions, app).listen(HTTPS_PORT, () => {
    logger.info(`Server is running https ${HTTPS_PORT}`);
})
